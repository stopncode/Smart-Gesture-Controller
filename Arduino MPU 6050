#include<Wire.h>   // library used for IIC 
long accelX, accelY, accelZ;
long gForceX, gForceY, gForceZ;

long gyroX, gyroY, gyroZ;
float rotX, rotY, rotZ;

void setup() 
{
  
  Serial.begin(9600);  
  Wire.begin();   //initialize II2 
  setupMPU();
Serial.print("Starting Program");
}

void loop() 
{
  //Serial.print("Starting Prgram");
  recordAccelRegisters();
  recordGyroRegisters();
  printData();
  delay(100);

}

void setupMPU()
{
  //Serial.print("Setup MPU");
Wire.beginTransmission(0x68); // register signal path reset
Wire.write(0x6B);  //accessing th register 6b Power MAnagement
Wire.write(0); //setting sleep Register to 0 (REQUIRED)
Wire.endTransmission(true);
Wire.beginTransmission(0x68); //I2C Address of MPU
Wire.write(0x1B);  //accessing Reg 1B- gyro config
Wire.write(0); //setting the gyro to full scale 250 deg./s
Wire.endTransmission(true);
Wire.beginTransmission(0x68); //I2C Address MPU
Wire.write(0x1C); // accessing the register 1C -accelerometer config
Wire.write(0); //Setting the accel to +-2g
Wire.endTransmission();
 // Serial.print("Finished setup.....          ");
}
void recordAccelRegisters()
{
  //Serial.print("Recording Accelerometer registers...      ");
Wire.beginTransmission(0x68);
Wire.write(0x3B); // starting with accel_Xout_H
Wire.endTransmission(false);
Wire.requestFrom(0x68,6,true);//reqest Accel register (3B-40) Hex address
//while(Wire.available() < 6);
accelX = Wire.read()<<8|Wire.read(); //store first two bytes OR...... SOME VALUE REPRESENTED IN BINARY
accelY=Wire.read()<<8|Wire.read(); //store middle two bytes
accelZ=Wire.read()<<8|Wire.read(); //store last two bytes
processAccelData();
//Serial.print("Finished...     ");
}

void processAccelData()
{
  ///Serial.print("Processing Accel Data...      ");
 gForceX= accelX /16384.0;
 gForceY= accelY /16384.0;
 gForceZ= accelZ /16384.0;
//Serial.print("Donzo     ");
}

void recordGyroRegisters()
{
  //Serial.print("recording Gyro data ");
Wire.beginTransmission(0x68);
Wire.write(0x43); //starting register for gyro reading 
Wire.endTransmission(false);
Wire.requestFrom(0x68,6, true);//request Gyro register (43 - 48) Hex address
//while(Wire.available() < 6);
gyroX = Wire.read()<<8|Wire.read(); //store first two bytes
gyroY = Wire.read()<<8|Wire.read(); //store middle two bytes
gyroZ = Wire.read()<<8|Wire.read(); //store last two bytes
//Serial.print("Done        ");
processGyroData(); 

}


void processGyroData()
{
  //Serial.print("processing gryo data..");
rotX = gyroX / 131.0;
rotY = gyroY / 131.0;
rotZ =gyroZ /131.0;
//Serial.print("done.    ");
}

void printData()
{
 Serial.print("Gyro (deg)"); //string with qoutes
 Serial.print(" x= ");  // print string
 Serial.print(rotX);
 Serial.print(" Y= ");
 Serial.print(rotY);
 Serial.print (" Z ");
 Serial.print(rotZ);
 Serial.print("Accel (g)");
 Serial.print(" X= ");
 Serial.print(gForceX);
 Serial.print(" Y=");
 Serial.print(gForceY);
 Serial.print(" Z= ");
 Serial.print(gForceZ);
 Serial.print("\t");
 Serial.println();
}
